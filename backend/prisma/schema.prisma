// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model Author {
    id           String    @id @default(cuid())
    displayName  String
    github       String?
    profileImage String?
    Post         Post[]
    Comment      Comment[]
    Likes        Likes[]
}

model Post {
    id          String    @id @default(cuid())
    author      Author    @relation(fields: [authorId], references: [id])
    authorId    String
    title       String
    source      String
    origin      String
    description String
    contentType String // [text/plain, text/markdown, application/base64, image/png;base64, image/jpeg;base64]
    content     String?
    image       String?
    categories  String[]
    count       Int
    published   DateTime
    visibility  String // [public, friends]
    unlisted    Boolean
    likeCount   Int       @default(0)
    Comment     Comment[]
    Likes       Likes[]
}

model Comment {
    id          String   @id @default(cuid())
    author      Author   @relation(fields: [authorId], references: [id])
    authorId    String
    post        Post     @relation(fields: [postId], references: [id])
    postId      String
    contentType String // [text/plain, text/markdown, application/base64, image/png;base64, image/jpeg;base64]
    comment     String
    published   DateTime
}

// Store number of likes for a post
model Likes {
    postId   String
    authorId String
    post     Post   @relation(fields: [postId], references: [id])
    author   Author @relation(fields: [authorId], references: [id])

    @@id([postId, authorId])
}
